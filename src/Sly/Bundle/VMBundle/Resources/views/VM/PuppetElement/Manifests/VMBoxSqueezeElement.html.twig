file { "/etc/udev/rules.d/70-persistent-net.rules":
    ensure => absent,
}

file { "/etc/udev/rules.d/75-persistent-net-generator.rules":
    ensure  => file,
    owner   => "root",
    group   => "root",
    mode    => "0644",
    content => "",
    notify  => Exec["reload-udev"],
}

exec { "reload-udev" :
    command     => "/sbin/udevadm control --reload-rules",
    refreshonly => true,
}

file { "/etc/apt/sources.list":
    ensure => file,
    owner  => root,
    group  => root,
    source => "/vagrant/files/sources.list",
}

exec { "import-gpg":
    command => "/usr/bin/wget -q http://www.dotdeb.org/dotdeb.gpg -O -| /usr/bin/apt-key add -"
}

exec { "/usr/bin/apt-get update":
    require => [File["/etc/apt/sources.list"], Exec["import-gpg"]],
}

{% if vm.phpVersion == '5.4' %}
exec { "/usr/bin/dpkg -P php5-suhosin":
    require => Package["php5"],
}
{% endif %}
